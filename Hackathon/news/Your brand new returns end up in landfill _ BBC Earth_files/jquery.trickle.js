!function(e){e.trickle=function(n,t){var o=this;o.$el=e(n),o.el=n,o.$el.data("trickle",o),o.init=function(){o.options=e.extend({},e.trickle.defaultOptions,t),$nav=o.$el,o.$moreUL=e('<ul class="more"/>'),o.$moreLink=e('<a href="javascript:void(0)" class="btn-toggle"/>'),o.$closeBtn=o.$moreLink.clone().addClass("btn btn-close"),$moreLI=e("<li/>"),$moreDropdown=e("<ul/>"),$moreText=e('<span class="more"/>').text(o.getMoreText()),$lessText=e('<span class="less"/>').text(o.getLessText()),$nav.find(">ul:not('.more')").addClass("full"),o.options.beforeInit(o.$el),o.$moreLink.append($moreText),o.$moreLink.append($lessText),o.$moreUL.append($moreLI),$moreLI.append(o.$moreLink),1==o.options.hasCloseBtn&&$moreDropdown.append(o.$closeBtn),$moreLI.append($moreDropdown),$nav.append(o.$moreUL),o.$nav=$nav,o.$navCont=o.$nav.find(">ul:not('.more')"),o.$more=o.$nav.find(">ul.more"),o.$moreCont=o.$more.find(">li>ul"),o.$moreBtn=o.$more.find(">li>a"),o.nbrChildren=o.$navCont.find(">li").length,o.initWatchers(),$nav.css("display","block"),o.respond(),$nav.addClass("initialized"),o.options.afterInit(o.$el)},o.initWatchers=function(){e(window).resize(function(){setTimeout(function(){o.respond()},o.options.respondDelay),o.$moreLink.css("width","auto")}),o.$el.on("click",".btn-toggle, .btn-close",function(e){e.preventDefault(),o.$moreUL.toggleClass("active"),o.$el.find("li.active").removeClass("active"),o.respond()})},o.respond=function(){var n=o.$nav.width(),t=n-o.options.padding,i=o.$navCont.children(),r=o.$moreCont.find(">li");if(e(window).width()<=o.options.mobileBreak)e(i.get().reverse()).each(function(){e(this).prependTo(o.$moreCont)}),o.$more.removeClass("hidden");else{o.$more.addClass("hidden"),r.each(function(){e(this).appendTo(o.$navCont)});for(var s=0;o.navItemsWidth()>t&&s<o.nbrChildren+1;)o.$navCont.children().last().prependTo(o.$moreCont),o.$moreCont.children("li:not(.btn-close)").length<=0?o.$more.addClass("hidden"):o.$more.removeClass("hidden"),s++;o.$more.find(".active").removeClass("active")}},o.navItemsWidth=function(){var n=0;return o.$nav.find(">ul:not('.hidden')>li").filter(function(){n+=e(this).outerWidth()}),n},o.getMoreText=function(){return void 0!=o.$el.data("moretext")?o.$el.data("moretext"):o.options.moreText},o.getLessText=function(){return void 0!=o.$el.data("lesstext")?o.$el.data("lesstext"):o.options.lessText},o.init()},e.trickle.defaultOptions={padding:200,moreText:"More...",lessText:"Less...",mobileBreak:650,respondDelay:0,hasCloseBtn:!0,beforeInit:function(){},afterInit:function(){}},e.fn.trickle=function(n){return this.each(function(){new e.trickle(this,n);e(this).data("trickle")})}}(jQuery);