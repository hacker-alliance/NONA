!function(e){function t(){if(!h){h=!0;for(var t in f)e(t).each(function(){var n,i;n=e(this),i=n.data("jqae"),(i.containerWidth!=n.width()||i.containerHeight!=n.height())&&s(n,f[t])});h=!1}}function n(e){f[e]&&(delete f[e],f.length||c&&(window.clearInterval(c),c=void 0))}function i(e,n){f[e]=n,c||(c=window.setInterval(function(){t()},200))}function r(){return 3===this.nodeType}function a(t){if(t.contents().length){var n=t.contents(),i=n.eq(n.length-1);if(i.filter(r).length){var o=i.get(0).nodeValue;return o=e.trim(o),""==o&&(i.remove(),!0)}for(;a(i););return!i.contents().length&&(i.remove(),!0)}return!1}function o(e){if(e.contents().length){var t=e.contents(),n=t.eq(t.length-1);return n.filter(r).length?n:o(n)}e.append("");var t=e.contents();return t.eq(t.length-1)}function l(t){var n=o(t);if(n.length){var i=n.get(0).nodeValue,r=i.lastIndexOf(" ");return r>-1?(i=e.trim(i.substring(0,r)),n.get(0).nodeValue=i):n.get(0).nodeValue="",!0}return!1}function s(t,n){var i=t.data("jqae");i||(i={});var r=i.wrapperElement;r||(r=t.wrapInner("<div/>").find(">div"),r.css({margin:0,padding:0,border:0}));var s=r.data("jqae");s||(s={});var c=s.originalContent;c?r=s.originalContent.clone(!0).data("jqae",{originalContent:c}).replaceAll(r):r.data("jqae",{originalContent:r.clone(!0)}),t.data("jqae",{wrapperElement:r,containerWidth:t.width(),containerHeight:t.height()});var f=t.height(),h=(parseInt(t.css("padding-top"),10)||0)+(parseInt(t.css("border-top-width"),10)||0)-(r.offset().top-t.offset().top),d=!1,g=r;n.selector&&(g=e(r.find(n.selector).get().reverse())),g.each(function(){var t=e(this),i=t.text(),s=!1;if(r.innerHeight()-t.innerHeight()>f+h)t.remove();else if(a(t),t.contents().length){for(d&&(o(t).get(0).nodeValue+=n.ellipsis,d=!1);r.innerHeight()>f+h;){if(s=l(t),!s){d=!0,t.remove();break}if(a(t),!t.contents().length){d=!0,t.remove();break}o(t).get(0).nodeValue+=n.ellipsis}"onEllipsis"==n.setTitle&&s||"always"==n.setTitle?t.attr("title",i):"never"!=n.setTitle&&t.removeAttr("title")}})}var c,f={},h=!1,d={ellipsis:"...",setTitle:"never",live:!1};e.fn.ellipsis=function(t,r){var a,o;return a=e(this),"string"!=typeof t&&(r=t,t=void 0),o=e.extend({},d,r),o.selector=t,a.each(function(){var t=e(this);s(t,o)}),o.live?i(a.selector,o):n(a.selector),this}}(jQuery);