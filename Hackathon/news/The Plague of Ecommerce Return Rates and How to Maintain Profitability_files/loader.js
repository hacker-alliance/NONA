(function(){var a=new function(){var b=this;this.widgetUrl="https://herowelcomebar.appspot.com/widget.html";this.scriptUrl="https://herowelcomebar.appspot.com/js/script.js";this.shop=Shopify.shop;this.init=function(){function c(g){var h=document.getElementsByTagName(g);var i=Array.prototype.slice.call(h,0);return i}if(b.scriptUrl){b.loadExternalScript(b.scriptUrl)}if(b.widgetUrl){var d="welcomebar".replace(/_/g,"-");var f=c("app:"+d);f=f.concat(c("app-"+d));for(var e=0;e<f.length;e++){b.renderApp(f[e])}}window.addEventListener("message",function(h){var j;var k=document.getElementsByTagName("iframe");for(var g=0;g<k.length;g++){if(k[g].contentWindow===h.source){j=k[g];break}}b.onMessage(h.data,j)},false)};this.renderApp=function(l){var m={};var c=l.attributes;for(var e=0;e<c.length;e++){var j=c.item(e).nodeName;var f=c.item(e).nodeValue;if(["src","frameborder"].indexOf(j)!=-1){continue}m[j]=f}m.width=m.width||"100%";m.height=m.height||"100%";m.style=m.style||"";m.style="visibility: visible !important; "+m.style;var n=m.id;var h=m.key||"1";var d=b.widgetUrl+"?shop="+b.shop+"&"+(n?"id="+n:"inffuse-project="+h);var k=document.createElement("iframe");k.setAttribute("frameborder","0");k.setAttribute("src",d);for(var g in m){k.setAttribute(g,m[g])}l.parentNode.replaceChild(k,l)};this.onMessage=function(d,c){if(typeof d.app=="undefined"||d.app!="inffuse"){return}switch(d.type){case"refreshWidget":b.refreshWidget(c);break;case"resize":b.resizeWidget(d.params,c);break}};this.refreshWidget=function(c){};this.resizeWidget=function(e,d){function c(f){if(typeof f=="string"){f=f.toLowerCase();if(f.indexOf("%")!=-1||f.indexOf("px")!=-1||f.indexOf("em")!=-1){return f}}return f+"px"}if(e.height){d.style.height=c(e.height)}if(e.width){d.style.width=c(e.width)}};this.loadScript=function(e){var d=document.getElementsByTagName("head")[0];var c=document.createElement("script");c.type="text/javascript";c.src=e;d.appendChild(c)};this.loadExternalScript=function(f){var d="welcomebar";var e="https://inffuse-platform.appspot.com/js/v0.1/"+d+"/inffuse.js";var c=d.toLowerCase().replace(/[-_ ](.)/g,function(h,i){return i.toUpperCase()});c=c.charAt(0).toUpperCase()+c.slice(1);var g={platform:"shopify",shop:b.shop,project:"1",alias:"Inffuse"+c,external:"true",script:"true"};g=Object.keys(g).map(function(h){return encodeURIComponent(h)+"="+encodeURIComponent(g[h])}).join("&").replace(/%20/g,"+");b.loadScript(e+"?"+g)}};a.init()})();
